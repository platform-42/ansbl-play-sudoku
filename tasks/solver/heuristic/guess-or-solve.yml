---
# guess-or-solve.yml

# guess -> pick MRV
- name: pick guessing cell
  ansible.builtin.include_tasks: tasks/solver/heuristic/guess-pick-mrv.yml

# no MRV -> puzzle solved
- name: stop puzzle
  ansible.builtin.set_fact:
    puzzle_solved: "{{ mrv_found == false }}"

# initial value
- name: initialize guess level
  ansible.builtin.set_fact:
    guess_level: 0
  when: 
    - not puzzle_solved

# propagate guess to neighbors
- name: propagate guess
  ansible.builtin.include_tasks: tasks/solver/heuristic/guess-apply.yml
  loop: "{{ mrv_domain }}"
  loop_control:
    loop_var: candidate
  when:
    - not puzzle_solved 

# if not solved -> rollback parent and return failure
- name: no candidate succeeded
  ansible.builtin.include_tasks: tasks/solver/heuristic/guess-rollback.yml
  when: 
    - not puzzle_solved

